---
output: 
  pdf_document:
    citation_package: natbib
    fig_caption: true
    #template: sv.latex.ms.tex
title: "Title"
date: "`r format(Sys.time(), '%B %d, %Y')`"
bibliography: biblio.bib
biblio-style: apa
geometry: margin=1in
fontsize: 11pt 
header-includes:
  - \usepackage{geometry}
  - \geometry{a4paper}
  - \usepackage[numbers]{natbib}
  - \usepackage{graphicx}
  - \usepackage[T1]{fontenc}
  - \usepackage[utf8]{inputenc}
  - \usepackage{textcomp}
  - \usepackage{gensymb}
  - \usepackage{amsmath}
  - \usepackage{amssymb}
  - \usepackage[running]{lineno}  # Corrected from 'lineo' to 'lineno'
  - \usepackage{setspace}
---

```{r, include= FALSE, warning=FALSE}
#citations:
#have a bib file and then to cite is [@nameofbib]
library(readr)
library(ggplot2)
library(tidyr)
library(MASS)  # For stepwise model selection
library(car)  # For VIF calculation
library(stargazer)  # For model summary table
library(corrplot)
library(xtable)  # Load the package
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(pastecs)
library(psych)
library(lmtest)
library(graphics)
library(gridExtra)  # For arranging multiple plots
```
### Introduction

## header

### Exploratory Data Analysis


```{r, echo=FALSE,warning=FALSE}
data_mort <- read.csv("http://users.stat.ufl.edu/~winner/data/myield.csv")

data_mort$smsa <- ifelse(data_mort$smsa == "Los Angeles-Long Bea", "Los Angeles-Long Beach", data_mort$smsa)
data_mort$smsa <- ifelse(data_mort$smsa == "San Francisco-Oaklan", "San Francisco-Oakland", data_mort$smsa)


# Compute R² values for each variable in simple regressions
r2_values <- round(sapply(c("X1", "X2", "X3", "X4", "X5", "X6"), function(var) {
  model <- lm(mortYld ~ data_mort[[var]], data = data_mort)
  summary(model)$r.squared
}), 3)

# Create a vector for the R² row (all values as characters)
r2_row <- c("Coefficient of determination (r²)", "", as.character(r2_values))

# Create the main table with renamed columns
table_data <- data_mort %>%
  select(smsa, mortYld, X1, X2, X3, X4, X5, X6) %>%
  rename(
     State = smsa,
    `Mortgage Yield (%)` = mortYld,
    `Avg Loan/ Mortgage Ratio` = X1,
    `Distance from Boston (miles)` = X2,
    `Savings per New Unit Built` = X3,
    `Savings per Capita` = X4,
    `Population Increase 1950-1960 (%)` = X5,
    `% First Mortgage from Inter-regional Banks` = X6
  ) %>%
  # Convert all columns to character to match the extra row
  mutate(across(everything(), as.character))

# Convert r2_row into a one-row data frame
r2_row_df <- as.data.frame(t(r2_row), stringsAsFactors = FALSE)
colnames(r2_row_df) <- colnames(table_data)

# Bind the R² row to the main table
final_table <- bind_rows(table_data, r2_row_df)


# Print the final table using knitr::kable
knitr::kable(final_table, 
             caption = "Mortgage Yield and Explanatory Variables (Simple Regression Results)", 
             format = "latex", booktabs = TRUE) %>%
  kable_styling(latex_options = c("scale_down", "hold_position")) %>%
  column_spec(1, width = "6cm", latex_valign = "m") %>%
  column_spec(2:8, width = "2cm", latex_valign = "m")
```

### Model Fitting (Max)

start with full model, that excludes x4 already because of previously said….
stepwise search → reduced model = mortYld ~X1+ X2+X3 
analysis of the model:
std. R table 	
max plots 
bp test (homeostaceifyuyri) and reset test (test interaction up to a certain degree)


### Discussion of any shortcomings of the final model (Matthew)

### Conclusioons (Matthew)
